/* styles.css
   Arrière-plan romantique et animations partagées pour l'application React. */

:root {
  --bg1: #ffeaf0;
  --accent1: #f8c8dc;
  --accent2: #e1c7ff;
  --text: #5a2f50;
  --cursor-image: url('ressources/hand.png');
  --cursor-width: 74px;
  --cursor-height: 74px;
  --cursor-offset-x: 18px;
  --cursor-offset-y: 10px;
  --cursor-origin-x: 18%;
  --cursor-origin-y: 12%;
}

html.cursor-hand {
  --cursor-image: url('ressources/hand.png');
  --cursor-width: 74px;
  --cursor-height: 74px;
  --cursor-offset-x: 18px;
  --cursor-offset-y: 10px;
  --cursor-origin-x: 18%;
  --cursor-origin-y: 12%;
}

html.cursor-foot {
  --cursor-image: url('ressources/pied.png');
  --cursor-width: 82px;
  --cursor-height: 82px;
  --cursor-offset-x: 30px;
  --cursor-offset-y: 42px;
  --cursor-origin-x: 36%;
  --cursor-origin-y: 24%;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
  color: var(--text);
  background-color: var(--bg1);
  min-height: 100vh;
  overflow: hidden;
  position: relative;
}

html.custom-cursor-active body,
html.custom-cursor-active body * {
  cursor: none !important;
}

.custom-hand-cursor {
  --cursor-x: -120px;
  --cursor-y: -120px;
  --cursor-scale: 1;
  position: fixed;
  left: 0;
  top: 0;
  width: var(--cursor-width);
  height: var(--cursor-height);
  pointer-events: none;
  background-image: var(--cursor-image);
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
  transform: translate3d(calc(var(--cursor-x) - var(--cursor-offset-x)), calc(var(--cursor-y) - var(--cursor-offset-y)), 0) scale(var(--cursor-scale));
  transform-origin: var(--cursor-origin-x) var(--cursor-origin-y);
  opacity: 0;
  transition: opacity 160ms ease, filter 160ms ease;
  z-index: 9999;
  will-change: transform;
  filter: drop-shadow(0 10px 24px rgba(244, 160, 200, 0.4));
}

.custom-hand-cursor[data-hidden="false"] {
  opacity: 1;
}

.custom-hand-cursor[data-active="true"] {
  --cursor-scale: 0.9;
}

.custom-hand-cursor[data-variant="interactive"] {
  filter: drop-shadow(0 12px 26px rgba(255, 150, 190, 0.55));
}

.custom-hand-cursor[data-variant="drag"] {
  filter: drop-shadow(0 10px 20px rgba(220, 120, 180, 0.5));
}

.custom-hand-cursor[data-variant="dragging"] {
  --cursor-scale: 0.85;
  filter: drop-shadow(0 10px 20px rgba(200, 100, 160, 0.48));
}

@keyframes bgShift {
  0% {
    background-position: 0% 50%;
    transform: scale(1);
  }
  50% {
    background-position: 100% 50%;
    transform: scale(1.04);
  }
  100% {
    background-position: 0% 50%;
    transform: scale(1);
  }
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  z-index: -3;
  background-image: url('ressources/coeur.jpg');
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  filter: brightness(0.95) saturate(1.12);
}

body::after {
  content: '';
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  background: conic-gradient(from 180deg at 50% 50%, rgba(255,230,245,0.34), rgba(230,210,255,0.26), rgba(245,230,255,0.24), rgba(255,230,245,0.34));
  background-size: 280% 280%;
  animation: bgShift 20s ease-in-out infinite;
}

html,
body,
#root {
  height: 100%;
}

.app-shell {
  position: relative;
  min-height: 100vh;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: clamp(120px, 18vh, 220px) clamp(12vw, 16vw, 18vw) clamp(220px, 24vh, 260px);
  text-align: center;
  z-index: 40;
  overflow: visible;
}

.phrase-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(2rem, 4vh, 3rem);
  width: 100%;
  max-width: clamp(460px, 58vw, 720px);
  margin: 0 auto;
  position: relative;
  z-index: 160;
}

.phrase {
  font-family: 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial, sans-serif;
  font-size: clamp(1.1rem, 3.2vw, 2.1rem);
  line-height: 1.38;
  color: var(--text);
  text-shadow: 0 8px 22px rgba(255, 210, 230, 0.42);
  font-weight: 400;
  margin: 0;
  max-width: min(98vw, 540px);
  margin-inline: auto;
  word-break: break-word;
  overflow-wrap: break-word;
}

.phrase span {
  display: inline;
}

.photo-stage {
  position: absolute;
  top: clamp(7vh, 11vh, 128px);
  bottom: clamp(150px, 16vh, 200px);
  left: 0;
  right: 0;
  padding: 0 clamp(7vw, 10vw, 12vw);
  pointer-events: auto;
  display: flex;
  justify-content: space-between;
  align-items: stretch;
  min-height: clamp(440px, 62vh, 720px);
  z-index: 80;
}

.photo-zone {
  position: relative;
  flex: 0 0 clamp(220px, 23vw, 380px);
  max-width: clamp(220px, 23vw, 400px);
  height: 100%;
  overflow: visible;
}

.photo-zone-left {
  margin-right: clamp(18px, 2vw, 36px);
}

.photo-zone-right {
  margin-left: clamp(18px, 2vw, 36px);
}

.photo-card {
  position: absolute;
  display: block;
  pointer-events: auto;
  cursor: zoom-in;
  border-radius: 32px;
  transform-origin: center;
  box-shadow: 0 30px 60px rgba(80, 38, 68, 0.22);
}

.photo-frame {
  width: 100%;
  height: 100%;
  border-radius: inherit;
  overflow: hidden;
  border: 3px solid rgba(255, 255, 255, 0.85);
  background: rgba(255, 255, 255, 0.95);
}

.photo-frame img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.photo-glow {
  position: absolute;
  left: 50%;
  bottom: -14px;
  transform: translateX(-50%);
  width: 78%;
  height: 26px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.5);
  filter: blur(20px);
  pointer-events: none;
}

.photo-lightbox {
  position: fixed;
  inset: 0;
  background: rgba(22, 8, 28, 0.78);
  backdrop-filter: blur(16px) saturate(120%);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: clamp(28px, 6vw, 80px);
  z-index: 640;
  cursor: zoom-out;
}

.photo-lightbox-inner {
  position: relative;
  max-width: min(96vw, 1320px);
  max-height: 96vh;
  width: auto;
  min-width: min(88vw, 640px);
  border-radius: clamp(26px, 4.2vw, 42px);
  overflow: hidden;
  box-shadow: 0 40px 120px rgba(36, 8, 28, 0.55), 0 12px 34px rgba(10, 0, 18, 0.35);
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.18), rgba(255, 255, 255, 0.02));
  border: 1px solid rgba(255, 255, 255, 0.32);
  cursor: auto;
  display: flex;
  flex-direction: column;
  backdrop-filter: blur(12px) saturate(130%);
}

.photo-lightbox-media {
  position: relative;
  width: 100%;
  flex: 1 1 auto;
  max-height: calc(96vh - clamp(148px, 20vh, 252px));
  background: radial-gradient(circle at center, rgba(255, 255, 255, 0.2), rgba(0, 0, 0, 0.4));
  display: flex;
  align-items: center;
  justify-content: center;
  padding: clamp(12px, 2.4vw, 28px);
}

.photo-lightbox-media img {
  position: relative;
  width: auto;
  height: auto;
  max-width: min(100%, calc(96vw - clamp(64px, 12vw, 160px)));
  max-height: calc(96vh - clamp(160px, 22vh, 260px));
  object-fit: contain;
  border-radius: clamp(20px, 3.4vw, 32px);
  box-shadow: 0 30px 60px rgba(48, 12, 32, 0.32), inset 0 0 0 2px rgba(255, 255, 255, 0.28);
  background: rgba(20, 12, 24, 0.4);
}

.photo-lightbox-caption {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(12px, 3vw, 28px);
  padding: clamp(18px, 3.5vw, 32px) clamp(22px, 4vw, 44px);
  color: rgba(255, 255, 255, 0.88);
  font-size: clamp(1rem, 2vw, 1.4rem);
  font-weight: 500;
  backdrop-filter: blur(24px) saturate(140%);
  background: linear-gradient(160deg, rgba(255, 255, 255, 0.18), rgba(70, 20, 50, 0.22));
}

.photo-lightbox-caption strong {
  font-weight: 600;
  letter-spacing: 0.02em;
}

.photo-lightbox-hint {
  font-size: clamp(0.85rem, 1.7vw, 1rem);
  color: rgba(255, 255, 255, 0.72);
  font-weight: 400;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.photo-lightbox-close {
  position: absolute;
  top: clamp(12px, 2vw, 30px);
  right: clamp(12px, 2vw, 30px);
  width: clamp(36px, 5vw, 52px);
  height: clamp(36px, 5vw, 52px);
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.92);
  color: #c71585;
  font-size: clamp(1.2rem, 2.6vw, 1.8rem);
  font-weight: 700;
  border: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 18px 44px rgba(123, 44, 100, 0.32);
  transition: transform 180ms ease, box-shadow 220ms ease, background 220ms ease, color 220ms ease;
  pointer-events: auto;
}

.photo-lightbox-close:hover {
  transform: translateY(-2px) scale(1.06);
  background: rgba(255, 255, 255, 1);
  color: #b20c73;
  box-shadow: 0 22px 46px rgba(123, 44, 100, 0.44);
}

.photo-lightbox-close:focus-visible {
  outline: none;
  box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.6), 0 22px 44px rgba(123, 44, 100, 0.4);
}

.love-controls {
  position: fixed;
  bottom: 6%;
  left: 50%;
  transform: translate(-50%, 0);
  display: flex;
  flex-wrap: nowrap;
  align-items: center;
  justify-content: center;
  gap: clamp(10px, 1.8vw, 20px);
  width: min(98vw, 1180px);
  padding: clamp(14px, 2.8vw, 26px) clamp(28px, 6vw, 72px);
  padding-left: clamp(32px, 6.6vw, 80px);
  padding-right: clamp(32px, 6.6vw, 80px);
  border-radius: 22px;
  background: rgba(255, 255, 255, 0.16);
  backdrop-filter: blur(12px);
  box-shadow: 0 18px 36px rgba(90, 46, 64, 0.22);
  border: 1px solid rgba(255, 255, 255, 0.22);
  z-index: 220;
  font-family: inherit;
  transition: opacity 280ms ease, transform 280ms ease;
  opacity: 1;
  pointer-events: auto;
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
  cursor: grab;
}

.love-controls::-webkit-scrollbar {
  display: none;
}

.love-controls.is-hidden {
  opacity: 0;
  transform: translate(-50%, 18px);
  pointer-events: none;
}

.love-controls.is-visible {
  transform: translate(-50%, 0);
  opacity: 1;
  pointer-events: auto;
}

.love-controls.is-floating {
  cursor: grab;
}

.love-controls.is-dragging {
  cursor: grabbing;
  transition: opacity 180ms ease;
  user-select: none;
}

.love-controls.is-dragging * {
  pointer-events: none;
}

.love-control-col {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  min-width: clamp(52px, 13vw, 96px);
  min-height: 68px;
  flex: 0 1 auto;
  padding: 0 2px;
}

.love-button-col {
  flex: 0 0 clamp(76px, 10vw, 112px);
}

.love-control-button {
  background: linear-gradient(135deg, #ff9fbf, #dca8ff);
  border: none;
  color: #ffffff;
  padding: 0 24px;
  border-radius: 999px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  height: 56px;
  min-width: clamp(84px, 24vw, 118px);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 12px 28px rgba(171, 60, 60, 0.18);
  transition: transform 160ms ease, box-shadow 160ms ease, filter 200ms ease;
}

.love-control-button:hover:not(:disabled) {
  transform: translateY(-4px);
  box-shadow: 0 22px 44px rgba(171, 60, 60, 0.32);
  filter: brightness(1.05);
}

.love-control-button:active:not(:disabled) {
  transform: translateY(2px) scale(0.97);
  box-shadow: 0 8px 20px rgba(171, 60, 60, 0.26);
}

.love-control-button:focus-visible {
  outline: none;
  box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.48), 0 18px 36px rgba(171, 60, 60, 0.32);
}

.love-control-button:disabled {
  opacity: 0.55;
  cursor: not-allowed;
  filter: grayscale(0.2) brightness(0.94);
}

.love-control-button.is-active {
  filter: brightness(1.08);
  box-shadow: 0 24px 48px rgba(171, 60, 60, 0.36);
}

.love-circle {
  width: 56px;
  min-width: 56px;
  height: 56px;
  border-radius: 50%;
  padding: 0;
  font-size: 1.15rem;
}

.love-slider-col {
  min-width: clamp(110px, 36vw, 220px);
  flex: 1 1 0;
}

.love-speed-slider {
  width: min(180px, 100%);
  appearance: none;
  -webkit-appearance: none;
  height: 12px;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
  box-shadow: inset 0 2px 4px rgba(91, 58, 69, 0.08);
  cursor: pointer;
}

.love-volume-slider {
  width: min(160px, 100%);
}

.love-speed-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #fff, #ffe6f1);
  border: 1px solid rgba(91, 58, 69, 0.12);
  box-shadow: 0 4px 10px rgba(248, 200, 220, 0.6);
  margin-top: -5px;
}

.love-speed-slider::-moz-range-thumb {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #fff, #ffe6f1);
  border: 1px solid rgba(91, 58, 69, 0.12);
  box-shadow: 0 4px 10px rgba(248, 200, 220, 0.6);
}

.love-speed-slider::-moz-range-track {
  height: 12px;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
}

.love-control-cap {
  font-size: 0.95rem;
  color: rgba(90, 47, 80, 0.85);
  font-weight: 600;
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.35);
}

.love-progress-col {
  align-items: stretch;
  min-width: clamp(180px, 36vw, 320px);
  flex: 1 0 clamp(240px, 32vw, 360px);
}

.love-progress-wrap {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(10px, 2vw, 18px);
}

.love-progress {
  flex: 1 1 auto;
  min-width: clamp(160px, 30vw, 280px);
  max-width: clamp(240px, 48vw, 360px);
  height: 8px;
  border-radius: 999px;
  overflow: hidden;
  background: rgba(255, 255, 255, 0.4);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
}

.love-progress-bar {
  height: 100%;
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
  transition: width 450ms ease;
}

.love-progress-text {
  margin-top: 0;
  font-size: 0.94rem;
  color: rgba(90, 47, 80, 0.78);
  font-weight: 600;
  text-align: right;
  min-width: 56px;
  white-space: nowrap;
}

.love-bgm-track {
  font-size: 0.9rem;
  color: rgba(90, 47, 80, 0.82);
  font-weight: 600;
  text-align: center;
  white-space: nowrap;
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.4);
}

.signature {
  position: fixed;
  right: 18px;
  bottom: 6.8%;
  z-index: 230;
  font-size: 0.86rem;
  color: #5b3a45;
  background: rgba(255, 255, 255, 0.76);
  padding: 6px 14px;
  border-radius: 999px;
  box-shadow: 0 12px 24px rgba(90, 46, 64, 0.18);
  backdrop-filter: blur(6px);
  font-weight: 600;
  letter-spacing: 0.2px;
}

@media (max-width: 900px) {
  .app-shell {
    padding: min(16vh, 140px) 4vw 24vh;
  }

  .love-controls {
    width: 94%;
    justify-content: flex-start;
    padding: 12px 18px;
    padding-left: 24px;
    padding-right: 28px;
  }

  .love-control-button {
    min-width: 94px;
  }
}

@media (max-width: 640px) {
  .app-shell {
    padding: 10vh 2vw 18vh;
  }

  .phrase {
    font-size: clamp(1rem, 5vw, 1.5rem);
    max-width: min(99vw, 340px);
    line-height: 1.22;
  }

  .love-controls {
    bottom: 8%;
    gap: 10px;
    padding: 12px 16px;
    justify-content: flex-start;
    padding-left: 20px;
    padding-right: 24px;
  }

  .love-control-col {
    min-width: 54px;
    min-height: 60px;
  }

  .love-button-col {
    flex: 0 0 clamp(64px, 22vw, 94px);
  }

  .love-control-button {
    min-width: 86px;
    height: 52px;
    font-size: 0.92rem;
  }

  .love-speed-slider {
    width: 126px;
  }

  .love-progress-wrap {
    gap: 10px;
  }

  .love-progress {
    min-width: clamp(120px, 52vw, 220px);
    max-width: clamp(150px, 64vw, 240px);
  }

  .love-progress-col {
    min-width: clamp(150px, 62vw, 260px);
    flex: 1 0 auto;
  }

  .love-progress-text {
    font-size: 0.9rem;
  }

  .love-volume-slider {
    width: min(140px, 100%);
  }

  .photo-lightbox {
    padding: clamp(20px, 8vw, 32px);
  }

  .photo-lightbox-inner {
    max-width: 96vw;
    border-radius: 28px;
    max-height: 94vh;
    min-width: auto;
  }

  .photo-lightbox-caption {
    flex-direction: column;
    align-items: flex-start;
    font-size: 1rem;
    padding: clamp(16px, 6vw, 24px);
  }

  .photo-lightbox-media {
    max-height: calc(94vh - clamp(150px, 26vh, 280px));
    padding: clamp(10px, 5vw, 24px);
  }

  .photo-lightbox-close {
    top: 14px;
    right: 14px;
  }

  .signature {
    font-size: 0.8rem;
    padding: 6px 12px;
    bottom: 12%;
  }
}

@media (max-width: 480px) {
  .photo-stage {
    height: clamp(260px, 52vh, 420px);
  }

  .love-controls {
    width: 92%;
    bottom: 10%;
    padding-left: 18px;
    padding-right: 22px;
  }

  .love-progress-col {
    width: 100%;
    align-items: center;
  }

  .love-button-col {
    flex: 0 0 clamp(60px, 28vw, 88px);
  }

  .love-progress {
    min-width: clamp(120px, 70vw, 210px);
    max-width: clamp(150px, 82vw, 230px);
  }

  .love-progress-col {
    min-width: clamp(140px, 84vw, 230px);
    flex: 1 0 auto;
  }

  .love-progress-text {
    font-size: 0.88rem;
  }

  .love-volume-slider {
    width: min(120px, 100%);
  }

  .photo-lightbox {
    padding: clamp(16px, 8vw, 26px);
  }

  .photo-lightbox-inner {
    border-radius: 24px;
    max-height: 94vh;
    min-width: auto;
  }

  .photo-lightbox-caption {
    padding: clamp(14px, 6vw, 22px);
    font-size: 0.96rem;
  }

  .photo-lightbox-media {
    max-height: calc(94vh - clamp(160px, 30vh, 280px));
    padding: clamp(10px, 6vw, 20px);
  }

  .photo-lightbox-close {
    width: 42px;
    height: 42px;
  }

  .signature {
    right: 50%;
    transform: translateX(50%);
  }
}

#particles {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 30;
}

.love-bg {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -2;
}

.love-word {
  position: absolute;
  color: rgba(255, 250, 255, 0.52);
  user-select: none;
  white-space: nowrap;
  animation: loveFloat 26s ease-in-out infinite alternate;
  font-weight: 600;
  letter-spacing: 0.4px;
  pointer-events: none;
  font-family: 'Dancing Script', 'Brush Script MT', cursive;
  font-style: italic;
  text-shadow: none;
}

@keyframes loveFloat {
  from {
    transform: translateY(-6px);
  }
  to {
    transform: translateY(6px);
  }
}

.big-next-btn {
  position: fixed;
  padding: 20px 40px;
  font-size: 1.8rem;
  font-weight: 700;
  background: linear-gradient(135deg, #ff9fbf, #dca8ff);
  color: #fff;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  box-shadow: 0 8px 20px rgba(248, 200, 220, 0.4);
  transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.4s ease-in-out, filter 0.3s ease;
  z-index: 420;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  display: block;
  min-width: 200px;
  opacity: 0;
  pointer-events: none;
  animation: floatyPulse 4.8s ease-in-out infinite;
}

.big-next-btn.is-hidden {
  opacity: 0;
  pointer-events: none;
}

.big-next-btn.is-visible {
  opacity: 1;
  pointer-events: auto;
}

.big-next-btn:hover {
  animation: none;
  transform: rotate(var(--rot, 0deg)) translateY(-6px) scale(1.06);
  box-shadow: 0 16px 40px rgba(220, 140, 220, 0.68);
  filter: brightness(1.02);
}

.big-next-btn:active {
  animation: none;
  transform: rotate(var(--rot, 0deg)) translateY(4px) scale(0.96);
  box-shadow: 0 6px 16px rgba(171, 60, 60, 0.24);
  filter: brightness(0.98);
}

.big-next-btn:focus-visible {
  animation: none;
  transform: rotate(var(--rot, 0deg)) translateY(-4px) scale(1.04);
  box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.45), 0 12px 30px rgba(220, 140, 220, 0.6);
  outline: none;
}

.big-next-btn.final-mode {
  --final-glow: 0 10px 30px rgba(248, 140, 180, 0.18);
  box-shadow: var(--final-glow), 0 6px 18px rgba(171, 60, 60, 0.08);
}

.big-next-btn.final-mode:hover {
  transform: rotate(var(--rot, 0deg)) translateY(-8px) scale(1.08);
  box-shadow: 0 18px 46px rgba(248, 140, 180, 0.32), 0 8px 24px rgba(171, 60, 60, 0.12);
}

.big-next-btn.final-mode:focus-visible {
  box-shadow: 0 18px 46px rgba(248, 140, 180, 0.28), 0 8px 24px rgba(171, 60, 60, 0.12);
}

@keyframes floatyPulse {
  0% {
    transform: rotate(var(--rot, 0deg)) translateY(0);
    box-shadow: 0 8px 20px rgba(248, 200, 220, 0.4);
  }
  50% {
    transform: rotate(var(--rot, 0deg)) translateY(-8px) scale(1.03);
    box-shadow: 0 18px 36px rgba(248, 200, 220, 0.48);
  }
  100% {
    transform: rotate(var(--rot, 0deg)) translateY(0);
    box-shadow: 0 8px 20px rgba(248, 200, 220, 0.4);
  }
}

.typewriter-caret {
  display: inline-block;
  width: 2px;
  height: 1.05em;
  background: var(--text);
  margin-left: 6px;
  vertical-align: middle;
  animation: blinkCaret 900ms steps(1) infinite;
}

@keyframes blinkCaret {
  50% {
    opacity: 0;
  }
}

.important {
  display: inline-block;
  color: #ffffff;
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
  padding: 2px 8px;
  border-radius: 999px;
  margin: 0 3px;
  font-weight: 600;
  animation: pulseImportant 1400ms ease-in-out infinite;
}

@keyframes pulseImportant {
  0% {
    transform: scale(1);
    filter: drop-shadow(0 2px 0 rgba(248, 200, 220, 0.15));
  }
  50% {
    transform: scale(1.08);
  }
  100% {
    transform: scale(1);
  }
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: none;
  cursor: pointer;
  font-weight: 700;
  color: #fff;
  transition: transform 160ms ease, box-shadow 160ms ease;
}

.btn:focus-visible {
  outline: 3px solid rgba(232, 214, 255, 0.6);
  outline-offset: 4px;
}

.btn-2 {
  background: linear-gradient(135deg, #ff9fbf, #dca8ff);
  box-shadow: 0 8px rgba(171, 60, 60, 0.12);
  padding: 0 22px;
  border-radius: 999px;
}

.btn-2i,
.btn-2j {
  border-radius: 50%;
  width: 90px;
  height: 90px;
  padding: 0;
  position: relative;
  top: 0;
  box-shadow: 0 6px rgba(171, 60, 60, 0.12);
}

.btn-2i:hover,
.btn-2j:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 24px rgba(171, 60, 60, 0.26);
}

.btn-2i:active,
.btn-2j:active {
  transform: translateY(4px);
  box-shadow: 0 0 0 rgba(171, 60, 60, 0.12);
}

.final-page-wrap {
  position: relative;
  z-index: 30;
  text-align: center;
  padding: clamp(6vh, 10vh, 12vh) 4vw;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1.2rem;
}

.final-title {
  font-size: clamp(3.6rem, 12vw, 9.4rem);
  font-weight: 900;
  color: var(--text);
  letter-spacing: 1.6px;
  margin: 0;
  text-shadow: 0 8px 28px rgba(169, 58, 90, 0.12), 0 2px 6px rgba(0, 0, 0, 0.06);
  animation: finalPop 900ms cubic-bezier(.16, .9, .34, 1) both;
}

@keyframes finalPop {
  0% {
    transform: translateY(8px) scale(0.96);
    opacity: 0;
  }
  60% {
    transform: translateY(-6px) scale(1.05);
    opacity: 1;
  }
  100% {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
}

.final-sub {
  font-size: clamp(1.1rem, 2.6vw, 1.6rem);
  color: rgba(90, 47, 80, 0.7);
  margin: 0;
}

.sparkles {
  display: block;
  height: 28px;
  margin: 0.6rem auto 1.2rem;
  width: min(560px, 85%);
  position: relative;
}

.sparkles::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, rgba(255, 255, 255, 0.45), rgba(248, 200, 220, 0.8), rgba(255, 255, 255, 0.45));
  border-radius: 2px;
  filter: blur(8px);
  opacity: 0.85;
}

.final-hearts-large {
  font-size: clamp(2.8rem, 8vw, 6rem);
  margin-top: 0.4rem;
}

.float-up {
  animation: floatUp 2400ms ease-out both;
}

@keyframes floatUp {
  0% {
    transform: translateY(20px);
    opacity: 0;
  }
  100% {
    transform: translateY(0);
    opacity: 1;
  }
}

.final-actions {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;
  gap: 18px;
  margin-top: 1.2rem;
}

.final-note {
  font-size: 0.95rem;
  color: rgba(90, 47, 80, 0.72);
}

.final-note a {
  color: rgba(90, 47, 80, 0.9);
  text-decoration: underline;
}

.bgm-widget {
  position: fixed;
  right: clamp(16px, 6vw, 40px);
  bottom: clamp(16px, 6vw, 40px);
  padding: clamp(14px, 3vw, 20px) clamp(16px, 4vw, 24px);
  display: flex;
  flex-direction: column;
  gap: 12px;
  background: rgba(255, 255, 255, 0.26);
  backdrop-filter: blur(16px) saturate(140%);
  border-radius: 22px;
  box-shadow: 0 18px 32px rgba(90, 46, 64, 0.24);
  z-index: 560;
  max-width: min(260px, 82vw);
}

.bgm-widget header {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.bgm-widget-title {
  margin: 0;
  font-size: 1rem;
  font-weight: 700;
  color: rgba(90, 47, 80, 0.88);
}

.bgm-widget-track {
  margin: 0;
  font-size: 0.82rem;
  font-weight: 500;
  color: rgba(90, 47, 80, 0.65);
}

.bgm-widget .love-control-button {
  width: 100%;
  min-width: 0;
}

.bgm-widget .love-speed-slider {
  width: 100%;
}

.bgm-volume-label {
  display: flex;
  flex-direction: column;
  gap: 8px;
  font-size: 0.85rem;
  font-weight: 600;
  color: rgba(90, 47, 80, 0.75);
}

@media (max-width: 640px) {
  .bgm-widget {
    right: clamp(12px, 4vw, 20px);
    bottom: clamp(12px, 4vw, 24px);
    gap: 10px;
  }
}
